import{g as _,a as k,c as C,u as S,U as d,b as m,d as $,e as M,_ as F,f as g,h as r,n as A,t as y,i as N,w as b,F as x,r as q,j as v,m as P,k as w,l as T,o as B,p as I,q as V,s as E,v as L,E as U,x as W,y as h,z as X}from"./index-n9KTMlqq.js";const p=k(),H={async getAccountBalance(t){if(!t)return;const e=await fetch(`${p.coreApiUrl}/extended/v1/address/${t}/stx`);if(e.status==200){const n=await e.json();return parseInt(n.balance)}},async getNFTHoldings(t,e,n,s,a,i){if(!t||!e||!n||!s)return;let o=`${p.coreApiUrl}/extended/v1/tokens/nft/holdings?principal=${s}&asset_identifiers=${t}.${e}::${n}`;a&&(o=o+`&limit=${a}`),i&&(o=o+`&offset=${i}`);const c=await fetch(o);if(c.status==200)return await c.json()},async resolveAddress(t){const e="Address invalid";if(!t||t.length==0)return{ret:-1,errMsg:e};if(t.indexOf(".")==-1)return{ret:0,value:t};const n=t.split(".");if(n.length!=2)return{ret:-2,errMsg:e};if(n[0].startsWith("SP")&&d.parseAddress(n[0]))return{ret:0,value:t};const s="SP2QEZ06AGJ3RKJPBV14SY1V5BBFNAW33D96YPGZF",a={contractAddress:s,contractName:"BNS-V2",functionName:"get-owner-name",functionArgs:[m(n[0].toLowerCase()),m(n[1].toLowerCase())],network:p,senderAddress:s},i=await $(a);let o=M(i);return o.type=="uint"?{ret:-1,errMsg:"BNS name not exists"}:{ret:0,value:o.value.value}},async queryNFTHistory(t,e,n,s,a){if(s)try{const i=a||0,o=`${p.coreApiUrl}/extended/v1/tokens/nft/history?asset_identifier=${t}.${e}::${n}&value=${C(S(s))}&offset=${i}`,c=await fetch(o);if(c.status==200){const l=await c.json(),u=l.results.length>0?l.results[l.results.length-1]:null;if(u)return u.asset_event_type=="mint"?u.tx_id:await this.queryNFTHistory(t,e,n,s,i+50)}}catch{d.alert(`Request server fail, tokenId=${s}, please try again 1 minute later.`)}},async queryAddressNonceInfo(t){if(!t)return;const e=await fetch(`${p.coreApiUrl}/extended/v1/address/${t}/nonces`);if(e.status==200)return await e.json()},openTxInBrowser(t){if(t){const e=`https://explorer.hiro.so/txid/${t}?chain=${_()}`;window.open(e,"_blank")}}},D=k(),f=I(),G={name:"MainPage",data(){return{bLoadFinish:!1,mintedCount:0,mintPrice:1e4,mintPriceStr:"99 STX",activeNames:[],faqItems:[{question:"What is Cyberpunk 2140 NFT?",answer:"Cyberpunk 2140 is a collection of 1000 unique digital assets living on the blockchain. Each NFT represents a unique character in the cyberpunk universe with distinct attributes and rarity levels."},{question:"Why can marketplace and wallet still function if this is fully on-chain?",answer:"While all data remains fully on-chain, the <a href='https://stacksinscription.com/#/purenft?tab=introduce' target='_blank' style='color:#fff'>PureNFT Protocol</a> maintains compatibility with existing NFT standards by retaining IPFS URIs to accelerate adoption. Current marketplaces and wallets still rely on these IPFS URIs to render images and metadata traits. We hope in the future they can read on-chain data directly, rather than depending on IPFS gateways."},{question:"What are the benefits of owning a Cyberpunk 2140 NFT?",answer:"<p>Hold to Earn:</p><p>1. Whenever someone mints, 10% of the minting fee is distributed as rewards to 10 randomly selected holders.</p><p>2. Whenever someone trades, 1.5% of the transaction value is distributed as rewards to 10 randomly selected holders.</p><p>3. Additional opportunities and events may be available for participation in the future.</p>"},{question:"How can I view my NFT after minting?",answer:"After minting, your NFT will appear in your connected wallet. You can also view it in marketplace websites."},{question:"What's the mint order?",answer:"During each mint, an on-chain random function is employed to randomly select a token from the available pool."}]}},mounted(){console.log("MainPage mounted");let t=this;d.registerEventByType("updateMinted",function(e){e.type=="updateMinted"&&t.updateMinted()}),d.getSelfGlobalData("minted")&&this.updateMinted()},methods:{updateMinted(){this.bLoadFinish=!0;let t=d.getSelfGlobalData("minted");this.mintedCount=t.mintedList.length},async handleMint(){if(!E.isUserSignedIn()){L();return}const t=U.service({lock:!0,background:"rgba(0, 0, 0, 0.6)"});try{const e=this.mintPrice,n=await H.getAccountBalance(T());console.log(`handleMint mintPrice=${e}, balance=${n}`);let[s,a]=[null,null];if(n<e?s=`Mint price is ${e/1e6} STX, balane is ${n/1e6} STX. Balane unenough`:n==e?s=`Mint price is ${e/1e6} STX, balane is ${n/1e6} STX. Need gas fee!`:n<e+1e6&&(a=`Mint price is ${e/1e6} STX, balane is ${n/1e6} STX. Make sure gas fee less than ${(n-e)/1e6} STX!`),s){d.alert(s);return}if(a){let i=this;this.$confirm(a,"Attention",{confirmButtonText:"Got it",cancelButtonText:"Cancel",type:"warning"}).then(()=>{i.realMint(e)})}else this.realMint(e)}finally{t.close()}},async realMint(t){let e=[];e.push(P(T(),w.LessEqual,t)),e.push(B(f.defaultContractAddress,f.cyberpunk2140Contract.name,w.GreaterEqual,0));const n={contractAddress:f.defaultContractAddress,contractName:f.cyberpunk2140Contract.name,functionName:"mint",functionArgs:[],network:D,appDetails:W(),postConditions:e,onFinish:s=>{d.alert(`Mint transaction has been sent. <a style="color:black" href="https://explorer.hiro.so/txid/${s.txId}?chain=mainnet" target="_blank">Visit transaction.</a>`)}};V(n)}}},R={class:"main-page"},j={class:"main-container"},O={class:"hero-section"},Y={class:"mint-section"},z={class:"mint-price"},J={class:"faq-section"},Q=["innerHTML"];function Z(t,e,n,s,a,i){const o=v("el-collapse-item"),c=v("el-collapse");return h(),g("div",R,[r("div",j,[r("div",O,[e[3]||(e[3]=r("h1",{class:"hero-title"},"Cyberpunk 2140",-1)),e[4]||(e[4]=r("p",{class:"hero-subtitle"},"The first fully on chain collection",-1)),r("div",Y,[r("div",{class:"progress-info",style:A({visibility:a.bLoadFinish?"visible":"hidden"})},y(a.mintedCount)+"/1000",5),r("button",{class:"mint-button",onClick:e[0]||(e[0]=(...l)=>i.handleMint&&i.handleMint(...l))},e[2]||(e[2]=[r("span",{class:"button-text"},"MINT",-1),r("div",{class:"button-glow"},null,-1)])),r("div",z,"Price: "+y(a.mintPriceStr),1)])]),r("div",J,[e[5]||(e[5]=r("h2",{class:"faq-title"},"FAQ",-1)),N(c,{modelValue:a.activeNames,"onUpdate:modelValue":e[1]||(e[1]=l=>a.activeNames=l),class:"cyber-collapse"},{default:b(()=>[(h(!0),g(x,null,q(a.faqItems,(l,u)=>(h(),X(o,{key:u,title:l.question,name:u,class:"faq-item"},{default:b(()=>[r("div",{class:"faq-answer",innerHTML:l.answer},null,8,Q)]),_:2},1032,["title","name"]))),128))]),_:1},8,["modelValue"])])])])}const ee=F(G,[["render",Z],["__scopeId","data-v-80fb5c1e"]]);export{ee as default};
